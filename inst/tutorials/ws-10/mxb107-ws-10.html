<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />



<meta name="progressive" content="false" />
<meta name="allow-skip" content="false" />

<title>MXB107 Worksheet 10 - Analysis of Variance</title>


<!-- highlightjs -->
<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>

<!-- taken from https://github.com/rstudio/rmarkdown/blob/67b7f5fc779e4cfdfd0f021d3d7745b6b6e17149/inst/rmd/h/default.html#L296-L362 -->
<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("section-TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>
<!-- end tabsets -->


<link rel="stylesheet" href="css/QUT.css" type="text/css" />
<link rel="stylesheet" href="css/QUTtutorial.css" type="text/css" />

</head>

<body>



<div class="pageContent band">
<div class="bandContent page">

<div class="topics">

<p style="margin-bottom:0.6cm;"></p>

<a><img src = "images/logo.png" height="100px" 
          alt = "MXB107 Blackboard Page"><span style="font-size:40px;color:#00407a"> &thinsp; MXB107 Introduction to Statistical Modelling</span></a>

<p style="margin-bottom:1cm;"></p>
<style type="text/css">
.pageContent {
}

.band {
  padding-left: 5%;
  padding-right: 5%;
  position: relative;
}

.bandContent {
  margin: 0 auto;
  max-width: 1200px;
}

.bandContent.page {
  display: flex;
  display: -ms-flexbox;
  display: -webkit-box;
  display: -webkit-flex;

  justify-content: space-between;
  -webkit-justify-content: space-between;
  -ms-flex-pack: justify;

  flex-direction: row-reverse;
  -webkit-flex-direction: row-reverse;
}

.topics {
  width: 75%;
  overflow-x: auto;
  padding-bottom: 600px;
}

.topics .tutorialTitle {
  display: none;
  border-bottom: 3px dotted #f0f0f0;
}

.topics .section.level2 {
  display: none;
  margin-bottom: 40px;
}

.topics .section.level2.current {
  display: block;
}

.topicsContainer {
  width: 23%;
  min-width: 270px;
  margin-right: 2%;
  z-index: 100;
}

.topicsPositioner {
  position: fixed;
  left: 0px;
  width: 100%;
  height: 0px;
  background-color: pink;
}

.topicsList {
  float: left;
  position: relative;
  width: 23%;
  min-width: 270px;
  overflow: auto;
  height: auto;
  scroll-behavior: smooth;
  transform: translateZ(0); /* force repaint to work on older browser used in the IDE */
}

.topicsHeader {
  display: flex;
  display: -ms-flexbox;
  display: -webkit-box;
  display: -webkit-flex;

  justify-content: space-between;
  -webkit-justify-content: space-between;
  -ms-flex-pack: justify;
}

.topicsFooter {
  margin-top: 10px;
  padding-bottom: 20px;
}

.topicsFooter .resetButton {
  padding-left: 10px;
  font-size: .66em;
  cursor: pointer;
  opacity: .7;
}

.topicsFooter .resetButton:hover {
  opacity: 1;
}

.topicsList .topic {
  line-height: 40px;
  font-size: 15px;
  padding-left: 10px;
  cursor: pointer;

  background-repeat: no-repeat;
  background-size: 2px 80px;
  background-position: left 100%;
  background-image: url(images/topicProgress.png);
  border-bottom: 1px solid #f8f8f8;

  -webkit-transition-property: background-position;
  transition-property: background-position;
  -webkit-transition-duration: 0.25s;
  transition-duration: 0.25s;
}

.topicsList .topic:hover {
  background-color: #fcfcfc;
}

.topicsList .topic.current {
  background-color: #f8f8f8;
}

.section.level3 {
  margin-bottom: 40px;
}

.paneCloser {
  display: none;
  height: 30px;
  width: 30px;
  background: url(images/close.svg) no-repeat center center;
  background-size: 30px 30px;
  border-radius: 15px;
  position: relative;
  top: 8px;
}

.paneCloser:hover {
  background-color: rgba( 0, 0, 0, .05);
}

.section.level3.hide {
  display: none;
}

.section.level3.done h3 {
  padding-left: 25px;
  background-image: url(images/exerciseDone.svg);
  background-size: 20px 20px;
  background-position: left center;
  background-repeat: no-repeat;
}

.exerciseActions {
  margin: 20px 0;
}

.skip {
  display: none;
}

.showSkip .skip {
  display: inline-block;
}

.topicActions {
  margin-top: 20px;
}

.topicActions button {
  margin-right: 10px;
}

.section.level2.hideActions .topicActions {
  display: none;
}

#doc-metadata {
  margin-bottom: 10px;
  line-height: 1.6em;
}

#doc-metadata h3 {
  margin: 0;
  font-size: 1.2em;
  line-height: 2em;
}

#doc-metadata h4 {
  margin: 0;
  font-size: 1em;
  line-height: 1.6em;
}

#doc-metadata em {
  font-style: normal;
}

@media screen and (max-width: 767px) {
  .topics {
    width: 99%;
  }

  .topics .tutorialTitle {
    display: block;
    cursor: pointer;
  }

  .topicsContainer {
    width: 1%;
    min-width: 1px;
    margin-right: 0;
  }

  .topicsList {
    padding: 0px 10px 20px 1%;
    background-color: rgba(255, 255, 255, 0.98);

    box-shadow: 0 5px 25px 0px rgba(0, 0, 0, 0.15);
    -webkit-box-shadow: 0 5px 25px 0px rgba(0, 0, 0, 0.15);
  }

  .topicsList.hideFloating {
    display: none;
  }
  

  .paneCloser {
    display: inline-block;
  }
}

.topicsList .topic.current {
    background-color: #124C7B;
    color: #EFF6FB;
    border: 0px;
}

/* override the width to be 100%, not 300px wide */
.shiny-input-container:not(.shiny-input-container-inline) {
  width: 100%;
}
.tutorial-exercise-support {
  width: 100%;
  max-width: 45em;
  display: none;
}

.slide .tutorial-exercise {
  width:100%;
  max-width: 45em;
  line-height: 1.4;
}

.tutorial-exercise {
  
  width:100%;
  max-width: 45em;
  position: relative;
}

.tutorial-exercise-input {
  margin-top: 15px;
}

.tutorial-panel-heading {
  background-color: #124C7B;
  color: #EFF6FB;
  padding-top: 6px;
  padding-bottom: 6px;
  padding-left: 8px;
  padding-right: 8px;
  font-size: 13px;
  font-weight: 500;
  width: 100%;
}
.tutorial-quiz-title {
  font-weight: 300;
  font-size: 18px;
  padding-top: 6px;
  padding-bottom: 0px;
  padding-left: 0px;
  padding-right: 8px;
  width: 100%;
}

.tutorial-question {
  padding-top: 10px;
  padding-bottom: 15px;
}

.tutorial-exercise-input .btn-xs {
  border-radius: 3px;
  color: #EFF6FB;
  border-color: #124C7B;
  background-color: #124C7B;
  margin-right: 0;
  margin-top: -1px;
  font-size: 11px;
  margin-left: 12px;
  padding-right: 8px;
  font-weight: normal;
}

.btn-light {
  border-radius: 3px;
  color: #EFF6FB;
  background-color: #124C7B;
  border-color: #EFF6FB;
}

.btn-light:hover
{
   color: #EFF6FB;
  background-color: #124C7B;
  border-color: #EFF6FB; 
}

.btn-primary
{
  border-radius: 3px;
  color: #EFF6FB;
  background-color: #124C7B;
  border-color: #333; 
}

.btn-default
{
  border-radius: 3px;
  color: #124C7B;
  background-color: #EFF6FB;
}

.btn-primary:hover
{
  color: #EFF6FB;
  background-color: #124C7B;
  border-color: #124C7B; 
}

.tutorial-exercise-input .btn-tutorial-solution {
  margin-left: 15px;
}

.tutorial-exercise-input .btn-tutorial-next-hint {
  margin-left: 15px;
  padding-right: 4px;
}

.tutorial-exercise-input .btn-xs i {
  color: #EFF6FB;
  border-color: #124C7B;
  width: 10px;
  margin-right: 1px;
}

.tutorial-exercise-input .panel-body {
  padding: 0;
}


.tutorial-exercise-code-editor {
  width: 100%;
}


.tutorial-solution-popover {
  max-width: none;
  width: 100%;
}

.tutorial-solution-popover.top>.arrow {
  margin-left: 0;
}

.tutorial-hint {
  color: #ecf0f1;
  background-color: #124C7B;

}

.ace-tm {
  font-family: monospace;
  font-size: 90%;
}


.tutorial-video-container {
  position: relative;
  margin-top: 15px;
  margin-bottom: 15px;
}

.tutorial-exercise-output>pre {
  max-height: 500px;
  overflow-y: auto;
}

.tutorial-video {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  border: solid 1px #cccccc;
}

/* Change colors for tabset tabset-pills */

.nav>li>a {
    position: relative;
    display: block;
    padding: 10px 15px;
    color: #124C7B;
}
.nav-pills>li.active>a, .nav-pills>li.active>a:hover, .nav-pills>li.active>a:focus {
    color: #ffffff;
    background-color: #124C7B;
}


section {
    float: left;
    margin: 10px;
    width: 60%;
    max-width: 45em;
}

p {
  max-width: 45em;
}

.r
{
  width: 100%;
  max-width: 45em;
}


.sidenote {
    float: right;
    clear: right;
    margin-right: -15%;
    width: 40%;
    margin-top: 0;
    margin-bottom: 1rem;
    font-size: 1.3rem;
    lineheight: 1.3;
    vertical-align: baseline;
    position: relative;
    color: ecf0f1;
    border: 1px solid black;
    padding: 5px 10px 5px;
}

.table {
  float: left;
  width: 100%;
  max-width:45em;
  margin: 10px 500px 10px 0px;
  padding: 5px 10px 5px;
}

.table-narrow {
  text-align: center;
  margin-left: auto;
  margin-right: auto;
  width: 50%;
}


.solution-panel {
  padding: 0 10px;
  background-color: white;
  display: none;
  overflow: hidden; 
}


.boxed {
    float: left;
    color: ecf0f1;
    border: 1px solid black;
    margin: 10px 500px 10px 0px;
    width: 100%;
    max-width: 45em;
    padding: 5px 10px 5px;
}    
</style>
<style type="text/css">.navbar-default {
  background-color: #124C7B;
  border-color: #124C7B;
}
.navbar-default .navbar-brand {
  color: #EFF6FB;
}
.navbar-default .navbar-brand:hover,
.navbar-default .navbar-brand:focus {
  color: #EFF6FB;
}
.navbar-default .navbar-text {
  color: #EFF6FB;
}
.navbar-default .navbar-nav > li > a {
  color: #EFF6FB;
}
.navbar-default .navbar-nav > li > a:hover,
.navbar-default .navbar-nav > li > a:focus {
  color: #EFF6FB;
}
.navbar-default .navbar-nav > .active > a,
.navbar-default .navbar-nav > .active > a:hover,
.navbar-default .navbar-nav > .active > a:focus {
  color: #EFF6FB;
  background-color: #124C7B;
}
.navbar-default .navbar-nav > .open > a,
.navbar-default .navbar-nav > .open > a:hover,
.navbar-default .navbar-nav > .open > a:focus {
  color: #EFF6FB;
  background-color: #124C7B;
}
.navbar-default .navbar-toggle {
  border-color: #124C7B;
}
.navbar-default .navbar-toggle:hover,
.navbar-default .navbar-toggle:focus {
  background-color: #124C7B;
}
.navbar-default .navbar-toggle .icon-bar {
  background-color: #EFF6FB;
}
.navbar-default .navbar-collapse,
.navbar-default .navbar-form {
  border-color: #EFF6FB;
}
.navbar-default .navbar-link {
  color: #EFF6FB;
}
.navbar-default .navbar-link:hover {
  color: #EFF6FB;
}

  .navbar-default .navbar-nav .open .dropdown-menu>li>a, .navbar-default .navbar-nav .open .dropdown-menu {
    background-color: #124C7B;
    color:#EFF6FB;
  }

@media (max-width: 767px) {
  .navbar-default .navbar-nav .open .dropdown-menu > li > a {
    color: #EFF6FB;
  }
  .navbar-default .navbar-nav .open .dropdown-menu > li > a:hover,
  .navbar-default .navbar-nav .open .dropdown-menu > li > a:focus {
    color: #EFF6FB;
  }
  .navbar-default .navbar-nav .open .dropdown-menu > .active > a,
  .navbar-default .navbar-nav .open .dropdown-menu > .active > a:hover,
  .navbar-default .navbar-nav .open .dropdown-menu > .active > a:focus {
    color: #EFF6FB;
    background-color: #124C7B;
  }
}

section {
    float: left;
    margin: 10px;
    width: 60%;
    max-width: 45em;
}

aside {
    width: 30%;
    padding-left: 15px;
    margin-left: 15px;
    float: right;
    border: 1px solid black;
}


#TOC {
    position: fixed;
    left: 10px;
    top: 60px;
    width: 200px;
    height: 100%;
    overflow: auto;
}

.boxed {
    float: left;
    color: ecf0f1;
    border: 1px solid black;
    margin: 10px 500px 10px 0px; 
    width: 100%;
    max-width: 45em;
    padding: 5px 10px 5px;
}


.sidenote {
    float: right;
    clear: right;
    margin-right: -15%;
    width: 40%;
    margin-top: 0;
    margin-bottom: 1rem;
    font-size: 1.3rem;
    lineheight: 1.3;
    vertical-align: baseline;
    position: relative;
    color: ecf0f1;
    border: 1px solid black;
    padding: 5px 10px 5px;
} 
</style>
<div id="section-the-analysis-of-variance" class="section level1">
<h1>The Analysis of Variance</h1>
<p>When considering hypothesis testing we looked at one-sample and two-sample cases, but is many instances,especially in experimental settings (e.g. lab experiments or clinical trials) we want to compare the effects of various <em>factors</em> that have more than one or two possible <em>levels</em>. In this case we need a more generalised approach to analysing results and testing hypotheses. The statistical technique used to analyse these data and test for the statistical significance of effects is called the analysis of variance (ANOVA).</p>
<div id="section-designing-experiments" class="section level2">
<h2>Designing Experiments</h2>
<p>An experiment is a trial that attempts to isolate the effects of factors of interest on specific outcomes while eliminating as much as possible extraneous effects on outcomes. Experiments are typically designed to focus on a few factors and include some degree of repetition and randomisation to make statistical inferences.</p>
<div class="boxed">
<p>An <strong>experimental unit</strong> is the object whose outcome or response is measured and is of interest in the process of the experiment. The outcome or response measured is called the dependent variable.</p>
<p>A <strong>factor</strong> is an independent variable controlled and varied by the experimenter. Factors are measured and varied in terms of levels or discrete states rather than as continuous or discrete numerical measures.</p>
<p>A <strong>treatment</strong> is a specific combination of factor levels.</p>
<p>A <strong>response</strong> is the variable measured by the experimenter, typically a continuous numeric response.</p>
</div>
<div id="section-analysis-of-variance-anova-explained" class="section level3 unnumbered">
<h3 class="unnumbered">Analysis of Variance (ANOVA) Explained</h3>
<p>We can explain the concept of Analysis of Variance (ANOVA) as a generalisation of a two-sample <span class="math inline">\(t\)</span>-test. Historically, ANOVA predates the maximum likelihood principle, and the Neyman-Pearson paradigm for hypothesis testing, and can be derived separately, but it is useful to think of it in terms of hypothesis testing for the purposes of inferencs.</p>
<div class="boxed">
<p><strong>Paint Coverage: Deriving the Sum of Squares for ANOVA</strong><br />
</p>
<p>House paint is sold in containers labelling the coverage and drying time for a single coat of paint. If manufacturers’ packaging claims that a four-litre can of their paint will cover the same area, how can we test if all three brands have the same coverage?</p>
<button class="solution">
Solution
</button>
<div class="solution-panel">
<p style="font-size:5px">
<br>
</p>
<p>We can think of this experiment as an example of a simple experiment testing a single factor (brand of paint) with multiple levels (brands of paint). If we are testing a single factor with two levels (Brand A versus Brand B), measuring the response (coverage in <span class="math inline">\(m^2\)</span>), results are analysed using a two-sample <span class="math inline">\(t\)</span>-test. Assuming that <span class="math inline">\(n_1=n_2=n\)</span>, we could write this out as a model for our responses as <span class="math display">\[y_{ij} = \mu_i+\epsilon_{ij}, i = A,B\mbox{ and } j = 1,\ldots,n\]</span> where <span class="math inline">\(\mu_i\)</span> is the mean for Brand A or Brand B, and <span class="math inline">\(j\)</span> is sample <span class="math inline">\(j\)</span> of the sample for Brand A or Brand B.</p>
<p><br> Now suppose that we wanted to investigate three brands of paint? (Brand A, Brand B, and Brand C). The two-sample <span class="math inline">\(t\)</span>-test is no longer a valid approach to analysing the data. Instead, can extend this statistical model for the experiment to analyse the data (assuming that each sample is of equal size, i.e. <span class="math inline">\(n_1+n_2+n_3=n\)</span> <span class="math display">\[y_{ij} = \mu_i+\epsilon_{ij}, i = A, B, C \mbox{ and } j = 1,\ldots,n\]</span></p>
<p>Let’s assume that the outcome of the experiment for replication <span class="math inline">\(j\)</span> of treatment <span class="math inline">\(i\)</span> that is the result for is <span class="math inline">\(y_{ij}\)</span>, then the total outcome of the experiment is <span class="math display">\[\mathbf{y} = (y_{11},y_{12},\ldots,y_{IJ})\]</span> where there are <span class="math inline">\(I\)</span> different treatments each replicated <span class="math inline">\(J\)</span> times, and <span class="math inline">\(n = IJ\)</span>. We can describe the total variation in experimental outcomes as the <strong>total sum of squares</strong> (<strong>SST</strong>) is defined as <span class="math display">\[SST = \sum_{i=1}^I\sum_{j=1}^J(y_{ij}-\bar{y}_{..})^2.\]</span> where <span class="math display">\[\bar{y}_{..}=\frac{1}{IJ}\sum_{i=1}^I\sum_{j=1}^Jy_{ij}\]</span> is the grand mean, the overall average response over all treatments and repetitions. The total sum of squares can be decomposed into two parts. First the sum of the squares of the error <strong>SSE</strong> is the pooled variation <em>within</em> treatment group <span class="math inline">\(i\)</span> <span class="math display">\[\begin{aligned}
SSE &amp;= (n_1-1)s_1^2+\cdots+(n_I-1)s_I^2\\
&amp;=\sum_{i=1}^I \sum_{j=1}^J (y_{ij}-\bar{y}_i)^2\end{aligned}\]</span> where <span class="math display">\[\bar{y}_{i}=\frac{1}{J}\sum_{j=1}^Jy_{ij}\]</span> or the mean for treatment <span class="math inline">\(i\)</span>. Second, the sum of the squares of the treatments <strong>SSTR</strong> is <span class="math display">\[SSTR = \sum_{i=1}^IJ(\bar{y}_{i}-\bar{y}_{..})^2\]</span> resulting in <span class="math display">\[SST = SSTR + SSE\]</span></p>
<p>We can show that we can decompose the total sum of squares into the sum of the squares of the treatments and the sum of the squares of the error.</p>
<p>Each source of variation is computed as a sum of squares, and can be divided by their degrees of freedom, as an estimate of their contribution to the total variance. These results are presented in an ANOVA table.</p>
<table>
<thead>
<tr class="header">
<th align="left">Source</th>
<th align="center">degrees of freedom</th>
<th align="center">Sum of Squares</th>
<th align="center">Mean Squares</th>
<th align="center"><span class="math inline">\(F\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Treatment</td>
<td align="center">I-1</td>
<td align="center">SSTR</td>
<td align="center">MSTR = SSTR/(I-1)</td>
<td align="center">MSTR/MSE</td>
</tr>
<tr class="even">
<td align="left">Error</td>
<td align="center">n-I</td>
<td align="center">SSE</td>
<td align="center">MSE = SSE/(n-I)</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">Total</td>
<td align="center">n-1</td>
<td align="center">SST</td>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody>
</table>
<p>Note that <span class="math inline">\(n = IJ\)</span> and the mean squares are just the sum of squares divided by their degrees of freedom. The statistic <span class="math inline">\(F\)</span> is the ratio of the MSTR and the MSE; or the ratio of the between treatment variation and the within treatment variation.</p>
</div>
</div>
</div>
</div>
<div id="section-anova-inference" class="section level2">
<h2>ANOVA Inference</h2>
<p>We assume that the observations <span class="math inline">\(y_{ij}\)</span> are distributed following a Gaussian distribution with a common variance <span class="math inline">\(\sigma^2\)</span>, but not necessarily the same mean. Under these assumeotions, the statistic <span class="math inline">\(F\)</span>, the ratio of the mean squares of ther treatment and the mean square of the error will follow an <span class="math inline">\(F\)</span>-distribution.</p>
<p>The <span class="math inline">\(F\)</span> distribution is a continuous probability distribution that describes the sampling distribution of the ratio of two sample variances. The <span class="math inline">\(F\)</span> distribution has two parameters, which are the degrees of freedom of the numerator and the degrees of freedom of the denominator. <span class="math display">\[
\frac{s_1^2}{s^2_2}\sim F_{\nu_1,\nu_2}
\]</span> where if <span class="math display">\[
s_1^2=\frac{1}{n_1-1}\sum_{i=1}^{n_1}(x_i-\bar{x})^2\quad\mbox{and}
\quad s^2_2=\frac{1}{n_2-1}\sum_{j=1}^{n_2}(y_j-\bar{y})^2
\]</span> then <span class="math display">\[
\nu_1 = n_1-1\quad \mbox{and}\quad \nu_2=n_2-1.
\]</span></p>
<p>We can think about this in terms of a hypothesis test; if you wanted to test whether or not one of your treatments produced a different outcome than the others, then you would use the hypotheses <span class="math display">\[
H_0: \mu_1=\mu_2=\cdots=\mu_I\qquad\mbox{and}\qquad H_A: \mbox{ at least one treatment mean is different}.
\]</span> Under these hypotheses, the null assumption means that <span class="math display">\[
SSTR\approx SSE
\]</span> i.e. that the variance between treatments was approximately equal to the variance within treatments, or that all treatment means are the same. So, in this case, you would reject the null hypothesis if MSTR was larger than MSE, or that basically, the treatment accounted for more of the total variance than the error. This decision translates to rejecting for large values of <span class="math inline">\(F\)</span>, so we can state that our rejection rule would be: <span class="math display">\[F&gt;F_{\mbox{critical}}\]</span> and just as in previous cases we can choose our critical value based on a Type I Error rate so that <span class="math display">\[
F_{\mbox{critical}} = F_{\nu_1,\nu_2,\alpha}
\]</span> where <span class="math display">\[
Pr(F&lt;F_{\mbox{critical}})= 1-\alpha.
\]</span> Finding the critical value for <span class="math inline">\(F\)</span> can be easily done using <code>R</code> or other statistical software. In practice, most statistical software will produce an ANOVA table with <span class="math inline">\(F\)</span> statistics computed and some indication of the results of testing.</p>
<div class="boxed">
<p><strong>Example:</strong><br />
</p>
<p>A study in Kirchhoefer (1979) reviewed the results of an experiment evaluating a semi-automated method for measuring chlorpheniramine maleate in tablets. The experimenter allocated ten samples to each of seven labs, and the results were analysed to determine if there were differences between the labs. The results in tabular form are:</p>
<div class="table-narrow">
<table style="width:78%;">
<colgroup>
<col width="11%" />
<col width="11%" />
<col width="11%" />
<col width="11%" />
<col width="11%" />
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Lab 1</th>
<th align="center">Lab 2</th>
<th align="center">Lab 3</th>
<th align="center">Lab 4</th>
<th align="center">Lab 5</th>
<th align="center">Lab 6</th>
<th align="center">Lab 7</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">4.13</td>
<td align="center">3.86</td>
<td align="center">4</td>
<td align="center">3.88</td>
<td align="center">4.02</td>
<td align="center">4.02</td>
<td align="center">4</td>
</tr>
<tr class="even">
<td align="center">4.07</td>
<td align="center">3.85</td>
<td align="center">4.02</td>
<td align="center">3.88</td>
<td align="center">3.95</td>
<td align="center">3.86</td>
<td align="center">4.02</td>
</tr>
<tr class="odd">
<td align="center">4.04</td>
<td align="center">4.08</td>
<td align="center">4.01</td>
<td align="center">3.91</td>
<td align="center">4.02</td>
<td align="center">3.96</td>
<td align="center">4.03</td>
</tr>
<tr class="even">
<td align="center">4.07</td>
<td align="center">4.11</td>
<td align="center">4.01</td>
<td align="center">3.95</td>
<td align="center">3.89</td>
<td align="center">3.97</td>
<td align="center">4.04</td>
</tr>
<tr class="odd">
<td align="center">4.05</td>
<td align="center">4.08</td>
<td align="center">4.04</td>
<td align="center">3.92</td>
<td align="center">3.91</td>
<td align="center">4</td>
<td align="center">4.1</td>
</tr>
<tr class="even">
<td align="center">4.04</td>
<td align="center">4.01</td>
<td align="center">3.99</td>
<td align="center">3.97</td>
<td align="center">4.01</td>
<td align="center">3.82</td>
<td align="center">3.81</td>
</tr>
<tr class="odd">
<td align="center">4.02</td>
<td align="center">4.02</td>
<td align="center">4.03</td>
<td align="center">3.92</td>
<td align="center">3.89</td>
<td align="center">3.98</td>
<td align="center">3.91</td>
</tr>
<tr class="even">
<td align="center">4.06</td>
<td align="center">4.04</td>
<td align="center">3.97</td>
<td align="center">3.9</td>
<td align="center">3.89</td>
<td align="center">3.99</td>
<td align="center">3.96</td>
</tr>
<tr class="odd">
<td align="center">4.1</td>
<td align="center">3.97</td>
<td align="center">3.98</td>
<td align="center">3.97</td>
<td align="center">3.99</td>
<td align="center">4.02</td>
<td align="center">4.05</td>
</tr>
<tr class="even">
<td align="center">4.04</td>
<td align="center">3.95</td>
<td align="center">3.98</td>
<td align="center">3.9</td>
<td align="center">4</td>
<td align="center">3.93</td>
<td align="center">4.06</td>
</tr>
</tbody>
</table>
</div>
<button class="solution">
Solution
</button>
<div class="solution-panel">
<p style="font-size:5px">
<br>
</p>
<p>If we want to test the hypotheses <span class="math display">\[
H_0: \mbox{There is no difference between labs}\quad\mbox{and}\quad H_A: \mbox{At least one lab is different}
\]</span> Then we can use the <span class="math inline">\(F\)</span> statistic and perform a <span class="math inline">\(F\)</span>-test. The degrees of freedom for the numerator and denominator can be taken from the table as 6 and 63 respectively use <code>R</code> to determine that <span class="math display">\[
F_{\mbox{critical}}=2.25
\]</span> for <span class="math inline">\(\alpha = 0.05\)</span>.</p>
<p>Unfortunately, further analysis requires using <code>R</code> rather than the tedious hand calculations involved.</p>
<pre class="r"><code>y &lt;- c(4.13,4.07,4.04,4.07,4.05,4.04,4.02,4.06,4.10,4.04,
       3.86,3.85,4.08,4.11,4.08,4.01,4.02,4.04,3.97,3.95,
       4.00,4.02,4.01,4.01,4.04,3.99,4.03,3.97,3.98,3.98,
       3.88,3.88,3.91,3.95,3.92,3.97,3.92,3.90,3.97,3.90,
       4.02,3.95,4.02,3.89,3.91,4.01,3.89,3.89,3.99,4.00,
       4.02,3.86,3.96,3.97,4.00,3.82,3.98,3.99,4.02,3.93,
       4.00,4.02,4.03,4.04,4.10,3.81,3.91,3.96,4.05,4.06)
labs &lt;- c(rep(&quot;Lab 1&quot;, 10),rep(&quot;Lab 2&quot;, 10), rep(&quot;Lab 3&quot;,10), rep(&quot;Lab 4&quot;,10),
          rep(&quot;Lab 5&quot;,10), rep(&quot;Lab 6&quot;,10),rep(&quot;Lab 7&quot;,10))

df &lt;- tibble(y = y, lab = labs)

model &lt;- lm(y~lab, data = df)

panderOptions(&#39;missing&#39;,&quot;&quot;)
model%&gt;%anova()%&gt;%pander()</code></pre>
<table style="width:87%;">
<caption>Analysis of Variance Table</caption>
<colgroup>
<col width="22%" />
<col width="6%" />
<col width="12%" />
<col width="15%" />
<col width="13%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">Sum Sq</th>
<th align="center">Mean Sq</th>
<th align="center">F value</th>
<th align="center">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>lab</strong></td>
<td align="center">6</td>
<td align="center">0.1247</td>
<td align="center">0.02079</td>
<td align="center">5.66</td>
<td align="center">9.453e-05</td>
</tr>
<tr class="even">
<td align="center"><strong>Residuals</strong></td>
<td align="center">63</td>
<td align="center">0.2314</td>
<td align="center">0.003673</td>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody>
</table>
<p><br />
<br> We can see from the results that the <em>MSE</em>=0.003673 and <em>MSTR</em>=0.02079 resulting in <em>F</em>=5.66, since the critical value of <em>F</em> is 2.25, we can reject the null hypothesis and assume that the measuring process in at least one lab is different than the others.</p>
<p>This example describes a single factor experiment where treatments are assigned to individuals completely at random or a fully randomised trial. The results from rejecting the null hypothesis tell us that at least one of the treatments results in different outcomes compared to the rest, but beyond that, it doesn’t tell us much, in fact, we need some more sophisticated tools.</p>
</div>
</div>
<div id="section-the-problem-of-multiple-comparisons" class="section level3 unnumbered">
<h3 class="unnumbered">The Problem of Multiple Comparisons</h3>
<p>THe <span class="math inline">\(F\)</span>-test for ANOVA is robust, and relatively straightforward; it is based on comparing the variance <em>within</em> groups (or treatments) and the variance <em>between</em> groups (or treatments). If we see that the variance between groups is much greater than the variance within groups we reject <span class="math inline">\(H_0\)</span> the null hypothesis that all groups or treatments have the same effect. Rejecting the null hypothesis however simply tells us that <em>at least one</em> of the treatments is different; not which one.</p>
<p>Instinctively we might suggest that a way of testing to see which treatment is different would be to perform multiple two-sample <span class="math inline">\(t\)</span>-test like we learned previously.</p>
<div class="boxed">
<p>In the example from Kirchhoefer (1979) there are seven labs, and to test all the possible pairwise comparisons we would have to perform <span class="math display">\[{7\choose 2} = 21\]</span> two-sample <span class="math inline">\(t\)</span>-tests. Each of these tests has a Type I Error Rate of <span class="math inline">\(\alpha\)</span>, thus in performing 21 tests the actual Type I Error Rate is the probability that you make at least one Type I error or <span class="math display">\[1-Pr(\mbox{you make no Type I errors}=1-(1-\alpha)^{21}.\]</span> We can calculate this for <span class="math inline">\(\alpha = 0.05\)</span> as <span class="math display">\[1-(1-0.05)^{21}=0.659\]</span> This result means that our testing procedure is far less reliable than we thought, and our inferences could be very wrong, meaning that we have a very high probability of making a mistake in deciding that two treatment means differ.</p>
</div>
</div>
<div id="section-testing-the-equality-of-the-treatment-means" class="section level3 unnumbered">
<h3 class="unnumbered">Testing the Equality of the Treatment Means</h3>
<p>There are a number of different approaches to addressing this problem of an inflated Type I error rate when testing the difference between multiple treatment means; one is Tukey’s Honest Significant Difference (HSD) based on the sampling distribution of <span class="math display">\[
q_{I,I(J-1)}\max_{i_1,i_2}\frac{|(\bar{y}_{i_1}-\mu_{i_1})-(\bar{y}_{i_2}-\mu_{i_2})|}{s_p/\sqrt{J}}
\]</span> or <strong>Tukey’s Studentised Range</strong>, where <span class="math inline">\(i_1\)</span> and <span class="math inline">\(i_2\)</span> refer to any arbitrary pairwise comparison of treatments. Using this sampling distribution, we can construct a confidence interval to perform the pairwise test of <span class="math display">\[
H_0: \mu_{i_1}=\mu_{i_2}\qquad\mbox{and}\qquad H_A: \mu_{i_1}\neq\mu_{i_2}.
\]</span> For a Type I Error Rate of <span class="math inline">\(\alpha\)</span> we can reject <span class="math inline">\(H_0\)</span> if <span class="math display">\[
|\bar{y}_{i_1}-\bar{y}_{i_2}|&gt;q_{I,I(J-1),\alpha}\frac{s_p}{\sqrt{J}}
\]</span> Finding values of <span class="math inline">\(q_{I,I(I-J),\alpha}\)</span> requires either special software (e.g. <code>R</code>) or a set of tables.</p>
<div class="boxed">
<p><strong>Example:</strong><br />
</p>
<p>In the example from Kirchhoefer (1979) the results of the hypothesis test indicates that at least one of labs produces different measurements than the rest. Use Tukey’s Honest Significant Difference to identify <em>which</em> labs differ from the others.</p>
<button class="solution">
Solution
</button>
<div class="solution-panel">
<p style="font-size:5px">
<br>
</p>
<p>Continuing with the example of lab measurements, we can list the labs in decreasing order of their mean measurements</p>
<table>
<thead>
<tr class="header">
<th align="center">Lab</th>
<th align="center">Mean</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">4.062</td>
</tr>
<tr class="even">
<td align="center">3</td>
<td align="center">4.003</td>
</tr>
<tr class="odd">
<td align="center">7</td>
<td align="center">3.998</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">3.997</td>
</tr>
<tr class="odd">
<td align="center">5</td>
<td align="center">3.957</td>
</tr>
<tr class="even">
<td align="center">6</td>
<td align="center">3.995</td>
</tr>
<tr class="odd">
<td align="center">4</td>
<td align="center">3.920</td>
</tr>
</tbody>
</table>
<p>For a Type I Error Rate of <span class="math inline">\(\alpha = 0.05\)</span> we can find <span class="math inline">\(q_{7,63,\alpha} = 4.31\)</span> in <code>R</code> <code>qtukey(0.95,7,63)</code> <span class="math inline">\(s_p\)</span> is the square root of the mean squared error (MSE) resulting in <span class="math inline">\(s_p = 0.06\)</span>. According to Tukey’s method we would reject the hypothesis that two means were the same if <span class="math display">\[|\bar{y}_{i_1}-\bar{y}_{i_2}|&gt;0.082\]</span> based on this, we conclude that mean of the measurements produced by Lab 1 differ from those of Lab 4, 5, and 6.</p>
<p>Note that if we had performed a regular <span class="math inline">\(t\)</span> test at the same Type I Error Rate, the rejection rule would have been <span class="math display">\[|\bar{y}_{i_1}-\bar{y}_{i_2}|&gt;0.053\]</span> and we would have concluded that Lab 1 produced measurements that differed from every other lab.</p>
<pre class="r"><code>y &lt;- c(4.13,4.07,4.04,4.07,4.05,4.04,4.02,4.06,4.10,4.04,
       3.86,3.85,4.08,4.11,4.08,4.01,4.02,4.04,3.97,3.95,
       4.00,4.02,4.01,4.01,4.04,3.99,4.03,3.97,3.98,3.98,
       3.88,3.88,3.91,3.95,3.92,3.97,3.92,3.90,3.97,3.90,
       4.02,3.95,4.02,3.89,3.91,4.01,3.89,3.89,3.99,4.00,
       4.02,3.86,3.96,3.97,4.00,3.82,3.98,3.99,4.02,3.93,
       4.00,4.02,4.03,4.04,4.10,3.81,3.91,3.96,4.05,4.06)
labs &lt;- c(rep(&quot;Lab 1&quot;, 10),rep(&quot;Lab 2&quot;, 10), rep(&quot;Lab 3&quot;,10), rep(&quot;Lab 4&quot;,10),
          rep(&quot;Lab 5&quot;,10), rep(&quot;Lab 6&quot;,10),rep(&quot;Lab 7&quot;,10))

df &lt;- tibble(y = y, lab = labs)

model &lt;- lm(y~lab, data = df)

panderOptions(&#39;missing&#39;,&quot;&quot;)
model%&gt;%anova()%&gt;%pander()</code></pre>
<table style="width:87%;">
<caption>Analysis of Variance Table</caption>
<colgroup>
<col width="22%" />
<col width="6%" />
<col width="12%" />
<col width="15%" />
<col width="13%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">Sum Sq</th>
<th align="center">Mean Sq</th>
<th align="center">F value</th>
<th align="center">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>lab</strong></td>
<td align="center">6</td>
<td align="center">0.1247</td>
<td align="center">0.02079</td>
<td align="center">5.66</td>
<td align="center">9.453e-05</td>
</tr>
<tr class="even">
<td align="center"><strong>Residuals</strong></td>
<td align="center">63</td>
<td align="center">0.2314</td>
<td align="center">0.003673</td>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody>
</table>
<pre class="r"><code>
model_res &lt;- model%&gt;%anova()
panderOptions(&#39;digits&#39;, 3)
(model%&gt;%aov()%&gt;%TukeyHSD())$lab%&gt;%round(3)%&gt;%pander()</code></pre>
<table style="width:75%;">
<colgroup>
<col width="25%" />
<col width="12%" />
<col width="12%" />
<col width="12%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">diff</th>
<th align="center">lwr</th>
<th align="center">upr</th>
<th align="center">p adj</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Lab 2-Lab 1</strong></td>
<td align="center">-0.065</td>
<td align="center">-0.148</td>
<td align="center">0.018</td>
<td align="center">0.217</td>
</tr>
<tr class="even">
<td align="center"><strong>Lab 3-Lab 1</strong></td>
<td align="center">-0.059</td>
<td align="center">-0.142</td>
<td align="center">0.024</td>
<td align="center">0.323</td>
</tr>
<tr class="odd">
<td align="center"><strong>Lab 4-Lab 1</strong></td>
<td align="center">-0.142</td>
<td align="center">-0.225</td>
<td align="center">-0.059</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center"><strong>Lab 5-Lab 1</strong></td>
<td align="center">-0.105</td>
<td align="center">-0.188</td>
<td align="center">-0.022</td>
<td align="center">0.005</td>
</tr>
<tr class="odd">
<td align="center"><strong>Lab 6-Lab 1</strong></td>
<td align="center">-0.107</td>
<td align="center">-0.19</td>
<td align="center">-0.024</td>
<td align="center">0.004</td>
</tr>
<tr class="even">
<td align="center"><strong>Lab 7-Lab 1</strong></td>
<td align="center">-0.064</td>
<td align="center">-0.147</td>
<td align="center">0.019</td>
<td align="center">0.232</td>
</tr>
<tr class="odd">
<td align="center"><strong>Lab 3-Lab 2</strong></td>
<td align="center">0.006</td>
<td align="center">-0.077</td>
<td align="center">0.089</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center"><strong>Lab 4-Lab 2</strong></td>
<td align="center">-0.077</td>
<td align="center">-0.16</td>
<td align="center">0.006</td>
<td align="center">0.083</td>
</tr>
<tr class="odd">
<td align="center"><strong>Lab 5-Lab 2</strong></td>
<td align="center">-0.04</td>
<td align="center">-0.123</td>
<td align="center">0.043</td>
<td align="center">0.758</td>
</tr>
<tr class="even">
<td align="center"><strong>Lab 6-Lab 2</strong></td>
<td align="center">-0.042</td>
<td align="center">-0.125</td>
<td align="center">0.041</td>
<td align="center">0.714</td>
</tr>
<tr class="odd">
<td align="center"><strong>Lab 7-Lab 2</strong></td>
<td align="center">0.001</td>
<td align="center">-0.082</td>
<td align="center">0.084</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center"><strong>Lab 4-Lab 3</strong></td>
<td align="center">-0.083</td>
<td align="center">-0.166</td>
<td align="center">0</td>
<td align="center">0.048</td>
</tr>
<tr class="odd">
<td align="center"><strong>Lab 5-Lab 3</strong></td>
<td align="center">-0.046</td>
<td align="center">-0.129</td>
<td align="center">0.037</td>
<td align="center">0.62</td>
</tr>
<tr class="even">
<td align="center"><strong>Lab 6-Lab 3</strong></td>
<td align="center">-0.048</td>
<td align="center">-0.131</td>
<td align="center">0.035</td>
<td align="center">0.572</td>
</tr>
<tr class="odd">
<td align="center"><strong>Lab 7-Lab 3</strong></td>
<td align="center">-0.005</td>
<td align="center">-0.088</td>
<td align="center">0.078</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center"><strong>Lab 5-Lab 4</strong></td>
<td align="center">0.037</td>
<td align="center">-0.046</td>
<td align="center">0.12</td>
<td align="center">0.818</td>
</tr>
<tr class="odd">
<td align="center"><strong>Lab 6-Lab 4</strong></td>
<td align="center">0.035</td>
<td align="center">-0.048</td>
<td align="center">0.118</td>
<td align="center">0.853</td>
</tr>
<tr class="even">
<td align="center"><strong>Lab 7-Lab 4</strong></td>
<td align="center">0.078</td>
<td align="center">-0.005</td>
<td align="center">0.161</td>
<td align="center">0.076</td>
</tr>
<tr class="odd">
<td align="center"><strong>Lab 6-Lab 5</strong></td>
<td align="center">-0.002</td>
<td align="center">-0.085</td>
<td align="center">0.081</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center"><strong>Lab 7-Lab 5</strong></td>
<td align="center">0.041</td>
<td align="center">-0.042</td>
<td align="center">0.124</td>
<td align="center">0.736</td>
</tr>
<tr class="odd">
<td align="center"><strong>Lab 7-Lab 6</strong></td>
<td align="center">0.043</td>
<td align="center">-0.04</td>
<td align="center">0.126</td>
<td align="center">0.691</td>
</tr>
</tbody>
</table>
<p>Tukey’s method can be used to construct confidence intervals for the difference between two treatment means (as shown). Statistical software (including <code>R</code>) produce special tables of pairwise comparisons for treatment means that illustrate both the ranking of the treatment means as well as the results of hypothesis testing to determine if differences are significant.</p>
<p>Note that looking at the table and reading the <span class="math inline">\(p\)</span>-values we can see that at the Type I error rate of <span class="math inline">\(\alpha=0.05\)</span> labs 4,5, and 6 are significantly different than lab 1 and that labs 4 and 3 are significantly different.</p>
</div>
</div>
</div>
</div>
<div id="section-randomised-block-designs-two-way-classification" class="section level2">
<h2>Randomised Block Designs: Two-Way Classification</h2>
<p>The single factor completely randomised designs previously described are extensions of two-sample <span class="math inline">\(t\)</span>-tests using <span class="math inline">\(F\)</span>-tests for inference and adjusting the Type I Error Rates to account for multiple comparisons. This model assumes that the only sources for observed variation in responses are either the treatment effects or random effects or experimental errors. Sometimes however it is obvious to the designer of an experiment that not all subjects are homogeneous, so the idea of allocating treatments completely at random might induce bias or otherwise invalidate our results. Often this heterogeneity is not able to be controlled by the experimenter, and is not of primary interest, but must be controlled. Controlling for this source of variation is done by using a <strong>randomised block design</strong>, which is a direct extension of the <em>matched pairs</em> or <em>paired difference</em> designs shown in Week 9.</p>
<div id="section-blocking" class="section level3 unnumbered">
<h3 class="unnumbered">Blocking</h3>
<p>In a randomised experimental design, if there are <span class="math inline">\(I\)</span> treatments of interest, the experimenter chooses <span class="math inline">\(J\)</span> blocks (<span class="math inline">\(J&gt;I\)</span>) each with <span class="math inline">\(I\)</span> subjects, one for each treatment. This scheme is to isolate the block to block variability that might obscure the treatment effects.</p>
<p>A researcher wants to know the average yield for three different species of fruit trees, but there is variation in yield depending on the field that the trees are planted in. The researcher is not interested in the variation due to the fields, so the researcher picks five different fields and divides each into three plots, and plants each of the three species in one of the plots.</p>
<p>In this example, two factors account for variation in the responses: the treatments and the blocks. Thus our model is now: <span class="math display">\[y_{ij} = \alpha_i+\beta_j+\epsilon_{ij}\]</span> where <span class="math inline">\(\alpha_i\)</span> is the mean effect for treatment <span class="math inline">\(i\)</span> and <span class="math inline">\(\beta_j\)</span> is the mean effect for block <span class="math inline">\(j\)</span>. We use ANOVA to explore the variation of both of these factors and random experimental error.</p>
</div>
<div id="section-the-anova-table-for-randomised-block-designs" class="section level3 unnumbered boxed">
<h3 class="unnumbered">The ANOVA Table for Randomised Block Designs</h3>
<p>To partition the variance let <span class="math inline">\(y_{ij}\)</span> be the response for treatment <span class="math inline">\(i\)</span> in block <span class="math inline">\(j\)</span>. Then the total variation for <span class="math inline">\(n=IJ\)</span> responses can be partitioned into three parts: <span class="math display">\[SST = SSB+SSTR+SSE\]</span> where SSB is the sum of the squares of the blocks, which measures the variability between blocks. <span class="math display">\[SSB = I\sum_{j=1}^J(\bar{y}_{j}-\bar{y}_{..})^2\]</span> where <span class="math display">\[\bar{y}_j = \frac{1}{I}\sum_{i=1}^Iy_{ij}.\]</span> and <span class="math display">\[SSE = \sum_{i=1}^I\sum_{j = 1}^J(y_{ij}-\bar{y}_j-\bar{y}_I-\bar{y}_{..})^2.\]</span> In this case the general form of the ANOVA table is</p>
<table>
<thead>
<tr class="header">
<th align="left">Source</th>
<th align="center">Sum of Squares</th>
<th align="center">degrees of freedom</th>
<th align="center">MS</th>
<th align="center">F</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Block</td>
<td align="center">SSB</td>
<td align="center">J-1</td>
<td align="center">SSB/(J-1)</td>
<td align="center">MSB/MSE</td>
</tr>
<tr class="even">
<td align="left">Treatment</td>
<td align="center">SSTR</td>
<td align="center">(I-1)</td>
<td align="center">SSTR/(I-1)</td>
<td align="center">MSTR/MSE</td>
</tr>
<tr class="odd">
<td align="left">Error</td>
<td align="center">SSE</td>
<td align="center">(I-1)(J-1)</td>
<td align="center">SSE/((I-1)(J-1))</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">Total</td>
<td align="center">SST</td>
<td align="center">n-1</td>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody>
</table>
<p>Note that the <span class="math inline">\(F\)</span> statistics can be used as in the single-factor design to the test the hypotheses: <span class="math display">\[
H_0:\mbox{All treatment means are the same.}\: \mbox{ vs }\: H_A:\mbox{At least one treatment mean is different.}
\]</span> or <span class="math display">\[
H_0:\mbox{All block means are the same}\:\mbox{ vs }\: H_A:\mbox{At least one block mean is different}.
\]</span> Also, we can use Tukey’s Honest Significant Differences (HSD) to rank and evaluate the differences between means for both treatments and blocks.</p>
</div>
<div class="boxed">
<p><strong>Example:</strong><br />
</p>
<p>A researcher is interested in the differences in price for different mobile phone providers. They want to compare prices from 4 different companies (A,B,C,D), but to account for differences between plans they create blocks based on different plan types: low, medium, and high usage. The resulting data are:</p>
<table style="width:53%;">
<colgroup>
<col width="19%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Usage Level</th>
<th align="center">A</th>
<th align="center">B</th>
<th align="center">C</th>
<th align="center">D</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Low</td>
<td align="center">27</td>
<td align="center">24</td>
<td align="center">31</td>
<td align="center">23</td>
</tr>
<tr class="even">
<td align="center">Medium</td>
<td align="center">68</td>
<td align="center">76</td>
<td align="center">65</td>
<td align="center">67</td>
</tr>
<tr class="odd">
<td align="center">High</td>
<td align="center">308</td>
<td align="center">326</td>
<td align="center">312</td>
<td align="center">300</td>
</tr>
</tbody>
</table>
<button class="solution">
Solution
</button>
<div class="solution-panel">
<p style="font-size:5px">
<br>
</p>
<p>The results for the ANOVA without blocking on the usage level are:</p>
<table style="width:83%;">
<caption>Analysis of Variance Model</caption>
<colgroup>
<col width="22%" />
<col width="6%" />
<col width="12%" />
<col width="13%" />
<col width="13%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th></th>
<th align="center">Df</th>
<th align="center">Sum Sq</th>
<th align="center">Mean Sq</th>
<th align="center">F value</th>
<th align="center">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Company</td>
<td align="center">3</td>
<td align="center">222</td>
<td align="center">74.1</td>
<td align="center">0.003</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td>Residuals</td>
<td align="center">8</td>
<td align="center">189577</td>
<td align="center">23697</td>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody>
</table>
<p><br> The results for the ANOVA blocking by usage lebel are:</p>
<table style="width:89%;">
<caption>Analysis of Variance Model Notice that when we block on the usage level, the <span class="math inline">\(p\)</span>-value for <code>Company</code> decreases, though it is still <em>not</em> statistically significant at the Type I error rate of <span class="math inline">\(\alpha = 0.05\)</span>, it is a substantial change. <!-- Source          Df      Sum Sq    Mean Sq   F value   Pr($>$F) --> <!-- ------------- ---- ----------- ---------- --------- ---------- --> <!-- Usage Level      2   189335.17   94667.58   2351.99     0.0000 --> <!-- Company          3      222.25      74.08      1.84     0.2404 --> <!-- Residuals        6      241.50      40.25        --></caption>
<colgroup>
<col width="27%" />
<col width="6%" />
<col width="12%" />
<col width="13%" />
<col width="13%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th></th>
<th align="center">Df</th>
<th align="center">Sum Sq</th>
<th align="center">Mean Sq</th>
<th align="center">F value</th>
<th align="center">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Usage Level</td>
<td align="center">2</td>
<td align="center">189335</td>
<td align="center">94668</td>
<td align="center">2352</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td>Company</td>
<td align="center">3</td>
<td align="center">222</td>
<td align="center">74.1</td>
<td align="center">1.84</td>
<td align="center">0.24</td>
</tr>
<tr class="odd">
<td>Residuals</td>
<td align="center">6</td>
<td align="center">242</td>
<td align="center">40.2</td>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody>
</table>
<p><strong>Without Blocking</strong><br />
</p>
<pre class="r"><code>df &lt;- tibble(`Usage_Level` = c(&quot;Low&quot;, &quot;Medium&quot;,&quot;High&quot;),A = c(27,68,308), B = c(24,76,326), C = c(31,65,312), D = c(23,67,300))

df_l &lt;- pivot_longer(df,cols = c(&quot;A&quot;,&quot;B&quot;,&quot;C&quot;,&quot;D&quot;),names_to = &quot;Company&quot;)
model &lt;- lm(value~.,data = df_l)
model_nb &lt;- lm(value~Company, df_l)

panderOptions(&#39;missing&#39;, &quot;&quot;)
panderOptions(&#39;round&#39;, 3)
panderOptions(&#39;plain.ascii&#39;, &#39;TRUE&#39;)
model_nb%&gt;%aov()%&gt;%pander()</code></pre>
<table style="width:83%;">
<caption>Analysis of Variance Model <br> And the results for Tukey’s HSD for Company without blocking by usage level are:</caption>
<colgroup>
<col width="22%" />
<col width="6%" />
<col width="12%" />
<col width="13%" />
<col width="13%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th></th>
<th align="center">Df</th>
<th align="center">Sum Sq</th>
<th align="center">Mean Sq</th>
<th align="center">F value</th>
<th align="center">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Company</td>
<td align="center">3</td>
<td align="center">222</td>
<td align="center">74.1</td>
<td align="center">0.003</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td>Residuals</td>
<td align="center">8</td>
<td align="center">189577</td>
<td align="center">23697</td>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody>
</table>
<pre class="r"><code>model_nb%&gt;%aov()%&gt;%TukeyHSD(which = &quot;Company&quot;)%&gt;%pander()</code></pre>
<ul>
<li><p><strong>Company</strong>:</p>
<table style="width:54%;">
<colgroup>
<col width="13%" />
<col width="11%" />
<col width="9%" />
<col width="8%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th></th>
<th align="center">diff</th>
<th align="center">lwr</th>
<th align="center">upr</th>
<th align="center">p adj</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>B-A</td>
<td align="center">7.67</td>
<td align="center">-395</td>
<td align="center">410</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td>C-A</td>
<td align="center">1.67</td>
<td align="center">-401</td>
<td align="center">404</td>
<td align="center">1</td>
</tr>
<tr class="odd">
<td>D-A</td>
<td align="center">-4.33</td>
<td align="center">-407</td>
<td align="center">398</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td>C-B</td>
<td align="center">-6</td>
<td align="center">-409</td>
<td align="center">397</td>
<td align="center">1</td>
</tr>
<tr class="odd">
<td>D-B</td>
<td align="center">-12</td>
<td align="center">-415</td>
<td align="center">391</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td>D-C</td>
<td align="center">-6</td>
<td align="center">-409</td>
<td align="center">397</td>
<td align="center">1</td>
</tr>
</tbody>
</table></li>
</ul>
<!-- end of list -->
<p><br></p>
<p><strong>With Blocking</strong><br />
</p>
<p>Now we add blocking on <code>Usage_Level</code></p>
<pre class="r"><code>panderOptions(&#39;missing&#39;, &quot;&quot;)
panderOptions(&#39;round&#39;, 3)
panderOptions(&#39;plain.ascii&#39;, &#39;TRUE&#39;)
model%&gt;%aov()%&gt;%pander()</code></pre>
<table style="width:86%;">
<caption>Analysis of Variance Model <br> And the results for Tukey’s HSD for Company with blocking by usage level are:</caption>
<colgroup>
<col width="25%" />
<col width="6%" />
<col width="12%" />
<col width="13%" />
<col width="13%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th></th>
<th align="center">Df</th>
<th align="center">Sum Sq</th>
<th align="center">Mean Sq</th>
<th align="center">F value</th>
<th align="center">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Usage_Level</td>
<td align="center">2</td>
<td align="center">189335</td>
<td align="center">94668</td>
<td align="center">2352</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td>Company</td>
<td align="center">3</td>
<td align="center">222</td>
<td align="center">74.1</td>
<td align="center">1.84</td>
<td align="center">0.24</td>
</tr>
<tr class="odd">
<td>Residuals</td>
<td align="center">6</td>
<td align="center">242</td>
<td align="center">40.2</td>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody>
</table>
<pre class="r"><code>model%&gt;%aov()%&gt;%TukeyHSD(which = &quot;Company&quot;)%&gt;%pander()</code></pre>
<ul>
<li><p><strong>Company</strong>:</p>
<table style="width:57%;">
<colgroup>
<col width="13%" />
<col width="11%" />
<col width="11%" />
<col width="9%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th></th>
<th align="center">diff</th>
<th align="center">lwr</th>
<th align="center">upr</th>
<th align="center">p adj</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>B-A</td>
<td align="center">7.67</td>
<td align="center">-10.3</td>
<td align="center">25.6</td>
<td align="center">0.502</td>
</tr>
<tr class="even">
<td>C-A</td>
<td align="center">1.67</td>
<td align="center">-16.3</td>
<td align="center">19.6</td>
<td align="center">0.987</td>
</tr>
<tr class="odd">
<td>D-A</td>
<td align="center">-4.33</td>
<td align="center">-22.3</td>
<td align="center">13.6</td>
<td align="center">0.836</td>
</tr>
<tr class="even">
<td>C-B</td>
<td align="center">-6</td>
<td align="center">-23.9</td>
<td align="center">11.9</td>
<td align="center">0.671</td>
</tr>
<tr class="odd">
<td>D-B</td>
<td align="center">-12</td>
<td align="center">-29.9</td>
<td align="center">5.93</td>
<td align="center">0.196</td>
</tr>
<tr class="even">
<td>D-C</td>
<td align="center">-6</td>
<td align="center">-23.9</td>
<td align="center">11.9</td>
<td align="center">0.671</td>
</tr>
</tbody>
</table></li>
</ul>
<!-- end of list -->
<p><br> And the results for Tukey’s HSD for usage level with blocking by usage level are:</p>
<pre class="r"><code>model%&gt;%aov()%&gt;%TukeyHSD(which = &quot;Usage_Level&quot;)%&gt;%pander()</code></pre>
<ul>
<li><p><strong>Usage_Level</strong>:</p>
<table style="width:65%;">
<colgroup>
<col width="25%" />
<col width="9%" />
<col width="9%" />
<col width="9%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th></th>
<th align="center">diff</th>
<th align="center">lwr</th>
<th align="center">upr</th>
<th align="center">p adj</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Low-High</td>
<td align="center">-285</td>
<td align="center">-299</td>
<td align="center">-271</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td>Medium-High</td>
<td align="center">-242</td>
<td align="center">-256</td>
<td align="center">-229</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td>Medium-Low</td>
<td align="center">42.8</td>
<td align="center">29</td>
<td align="center">56.5</td>
<td align="center">0</td>
</tr>
</tbody>
</table></li>
</ul>
<!-- end of list -->
<p>Note that there appear to be significant differences between costs for various usage levels, but not between companies. So while it is evident that there is a difference between the costs for usage levels (and this is not of interest), it appears that even when accounting for usage level, there are still no significant differences in costs between service providers.</p>
</div>
</div>
</div>
<div id="section-two-factor-experiments" class="section level2">
<h2>Two-Factor Experiments</h2>
<p>A randomised block design provides some structure as to allocating treatments to account for between block variation to control for extraneous sources of variation that are not of interests. But in many cases a researcher may want to explore the effects of two different factors (both of interest) as well as their interaction (definitely of interest). Experiments of this kind are called Two-Factorial Experiments.</p>
<p>Medical researchers often want to test the effects of various drugs, but in many cases, patients may be taking more than one medication. In this case, researchers need to test the effects of multiple medications and their interactions on patient outcomes using the model <span class="math display">\[
y_{ijk} = \alpha_i+\beta_j+(\alpha\beta)_{ij}+\epsilon_{ijk}
\]</span> where <span class="math inline">\(\alpha_i\)</span> is the mean effect for drug 1, <span class="math inline">\(\beta_j\)</span> is the mean effect of drug 2, and <span class="math inline">\((\alpha\beta)_{ij}\)</span> is the mean effect of the interaction between drug 1 and drug 2.</p>
<div id="section-anova-for-two-factor-experiments" class="section level3 unnumbered boxed">
<h3 class="unnumbered">ANOVA for Two-Factor Experiments</h3>
<p>In a two factor experiment, factor A may have <span class="math inline">\(I\)</span> levels, factor B may have <span class="math inline">\(J\)</span> levels and each of these replicated <span class="math inline">\(K\)</span> times, making <span class="math inline">\(y_{ijk}\)</span> observation <span class="math inline">\(k\)</span> of the combination of treatments <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>. We then can partition the total sum of squares into four parts <span class="math display">\[
SST  = SSA + SSB + SSAB + SSE
\]</span> where:</p>
<ul>
<li><p>SSA measures the variation among the means of factor A.</p></li>
<li><p>SSB measures the variation among the means of factor B.</p></li>
<li><p>SSAB measures the variation among the different combinations of levels for A and B.</p></li>
<li><p>SSE measures the variation among the observations within each combination of levels for A and B.</p></li>
</ul>
<p>Given that there are <span class="math inline">\(I\)</span> levels for factor A, <span class="math inline">\(J\)</span> levels for factor B, and <span class="math inline">\(K\)</span> replicates of each combination, the total number of observations is <span class="math inline">\(n = IJK\)</span>.</p>
<p>Setting aside the exact formulae for computing the sums of squares, the resulting ANOVA table for analysis is</p>
<table>
<thead>
<tr class="header">
<th align="left">Source</th>
<th align="center">Degrees of Freedom</th>
<th align="center">Sum of Squares</th>
<th align="center">Mean Squares</th>
<th align="center">F</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">A</td>
<td align="center">I-1</td>
<td align="center">SSA</td>
<td align="center">SSA/(I-1)</td>
<td align="center">MSA/MSE</td>
</tr>
<tr class="even">
<td align="left">B</td>
<td align="center">J-1</td>
<td align="center">SSB</td>
<td align="center">SSB/(J-1)</td>
<td align="center">MSB/MSE</td>
</tr>
<tr class="odd">
<td align="left">AB</td>
<td align="center">(I-1)(J-1)</td>
<td align="center">SSAB</td>
<td align="center">SSAB/((I-1)(J-1))</td>
<td align="center">MSAB/MSE</td>
</tr>
<tr class="even">
<td align="left">Error</td>
<td align="center">IJ(K-1)</td>
<td align="center">SSE</td>
<td align="center">SSE/IJ(K-1)</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">Total</td>
<td align="center">IJK-1</td>
<td align="center">SST</td>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody>
</table>
<p>Much of the analyses and inference carries over from the previous examples but extended to the two-factor case. The hypotheses of interest then become. <span class="math display">\[
H_0: \mbox{Factor A treatment means are equal}\:\mbox{ vs }\: H_A: \mbox{At least one treatment mean is different}
\]</span> <span class="math display">\[
H_0: \mbox{Factor B treatment means are equal}\:\mbox{ vs }\: H_A: \mbox{At least one treatment mean is different}
\]</span> <span class="math display">\[
H_0: \mbox{There is no interaction between A and B}\quad\mbox{vs}\quad H_A: \mbox{Factors A and B interact}
\]</span></p>
</div>
<p>We can test these hypotheses using a specified Type I Error Rate (typically <span class="math inline">\(\alpha = 0.05\)</span>) and identifying the appropriate rejection region for their <span class="math inline">\(F\)</span> statistics. Also, Tukey’s HSD can be used to assess the individual treatment differences.</p>
<div class="boxed">
<p><strong>Example:</strong><br />
</p>
<p>The manager of a manufacturing plant knows that the output of a production line depends on two factors:</p>
<ul>
<li><p>Which of two supervisors is in charge of the line</p></li>
<li><p>Which of three shifts (day, night, or swing) is working</p></li>
</ul>
The following data are collected echo
<div style="padding: 0 50px">
<table style="width:49%;">
<colgroup>
<col width="18%" />
<col width="8%" />
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Supervisor</th>
<th align="center">Day</th>
<th align="center">Swing</th>
<th align="center">Night</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">571</td>
<td align="center">480</td>
<td align="center">470</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">610</td>
<td align="center">474</td>
<td align="center">430</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">625</td>
<td align="center">540</td>
<td align="center">450</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">480</td>
<td align="center">625</td>
<td align="center">630</td>
</tr>
<tr class="odd">
<td align="center">2</td>
<td align="center">516</td>
<td align="center">600</td>
<td align="center">680</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">465</td>
<td align="center">581</td>
<td align="center">661</td>
</tr>
</tbody>
</table>
</div>
<button class="solution">
Solution
</button>
<div class="solution-panel">
<p style="font-size:5px">
<br>
</p>
<p>The results for the ANOVA analysis in tabular form are:</p>
<table style="width:93%;">
<caption>Analysis of Variance Model</caption>
<colgroup>
<col width="31%" />
<col width="6%" />
<col width="12%" />
<col width="13%" />
<col width="13%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th></th>
<th align="center">Df</th>
<th align="center">Sum Sq</th>
<th align="center">Mean Sq</th>
<th align="center">F value</th>
<th align="center">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Supervisor</td>
<td align="center">1</td>
<td align="center">19208</td>
<td align="center">19208</td>
<td align="center">26.7</td>
<td align="center">2e-04</td>
</tr>
<tr class="even">
<td>Shift</td>
<td align="center">2</td>
<td align="center">247</td>
<td align="center">124</td>
<td align="center">0.172</td>
<td align="center">0.844</td>
</tr>
<tr class="odd">
<td>Supervisor:Shift</td>
<td align="center">2</td>
<td align="center">81127</td>
<td align="center">40564</td>
<td align="center">56.3</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td>Residuals</td>
<td align="center">12</td>
<td align="center">8640</td>
<td align="center">720</td>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody>
</table>
<p>These results indicate that there doesn’t appear to be a significant difference between shifts, but that there is a significant difference between supervisors. This can be explored by looking at the differences in the mean outcome for each supervisors for each shift using Tukey’s HSD:</p>
<table style="width:92%;">
<colgroup>
<col width="30%" />
<col width="13%" />
<col width="15%" />
<col width="13%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">diff</th>
<th align="center">lwr</th>
<th align="center">upr</th>
<th align="center">p adj</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>2:Day-1:Night</strong></td>
<td align="center">37</td>
<td align="center">-36.6</td>
<td align="center">111</td>
<td align="center">0.562</td>
</tr>
<tr class="even">
<td align="center"><strong>1:Swing-1:Night</strong></td>
<td align="center">48</td>
<td align="center">-25.6</td>
<td align="center">122</td>
<td align="center">0.309</td>
</tr>
<tr class="odd">
<td align="center"><strong>2:Swing-1:Night</strong></td>
<td align="center">152</td>
<td align="center">78.4</td>
<td align="center">226</td>
<td align="center">2e-04</td>
</tr>
<tr class="even">
<td align="center"><strong>1:Day-1:Night</strong></td>
<td align="center">152</td>
<td align="center">78.4</td>
<td align="center">226</td>
<td align="center">2e-04</td>
</tr>
<tr class="odd">
<td align="center"><strong>2:Night-1:Night</strong></td>
<td align="center"><strong>207</strong></td>
<td align="center"><strong>133</strong></td>
<td align="center"><strong>281</strong></td>
<td align="center"><strong>0</strong></td>
</tr>
<tr class="even">
<td align="center"><strong>1:Swing-2:Day</strong></td>
<td align="center">11</td>
<td align="center">-62.6</td>
<td align="center">84.6</td>
<td align="center">0.995</td>
</tr>
<tr class="odd">
<td align="center"><strong>2:Swing-2:Day</strong></td>
<td align="center">115</td>
<td align="center">41.4</td>
<td align="center">189</td>
<td align="center">0.0022</td>
</tr>
<tr class="even">
<td align="center"><strong>1:Day-2:Day</strong></td>
<td align="center"><strong>115</strong></td>
<td align="center"><strong>41.4</strong></td>
<td align="center"><strong>189</strong></td>
<td align="center"><strong>0.0022</strong></td>
</tr>
<tr class="odd">
<td align="center"><strong>2:Night-2:Day</strong></td>
<td align="center">170</td>
<td align="center">96.4</td>
<td align="center">244</td>
<td align="center">1e-04</td>
</tr>
<tr class="even">
<td align="center"><strong>2:Swing-1:Swing</strong></td>
<td align="center"><strong>104</strong></td>
<td align="center"><strong>30.4</strong></td>
<td align="center"><strong>178</strong></td>
<td align="center"><strong>0.0049</strong></td>
</tr>
<tr class="odd">
<td align="center"><strong>1:Day-1:Swing</strong></td>
<td align="center">104</td>
<td align="center">30.4</td>
<td align="center">178</td>
<td align="center">0.0049</td>
</tr>
<tr class="even">
<td align="center"><strong>2:Night-1:Swing</strong></td>
<td align="center">159</td>
<td align="center">85.4</td>
<td align="center">233</td>
<td align="center">1e-04</td>
</tr>
<tr class="odd">
<td align="center"><strong>1:Day-2:Swing</strong></td>
<td align="center">0</td>
<td align="center">-73.6</td>
<td align="center">73.6</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center"><strong>2:Night-2:Swing</strong></td>
<td align="center">55</td>
<td align="center">-18.6</td>
<td align="center">129</td>
<td align="center">0.195</td>
</tr>
<tr class="odd">
<td align="center"><strong>2:Night-1:Day</strong></td>
<td align="center">55</td>
<td align="center">-18.6</td>
<td align="center">129</td>
<td align="center">0.195</td>
</tr>
</tbody>
</table>
<p>These results indicate that there is a significant difference between supervisors for each shift, but that while supervisor 2 appears to perform better over all (and on the swing and night shifts), supervisor 1 performs better on the day shift.</p>
<pre class="r"><code>df &lt;- tibble(Supervisor = c(1,1,1,2,2,2)%&gt;%as.factor(), 
             Day = c(571,610,625,480,516,465), 
             Swing = c(480,474,540,625,600,581),
             Night = c(470,430,450,630,680,661))
df_l &lt;- pivot_longer(df,cols = c(Day,Swing,Night),names_to = &quot;Shift&quot;)
model &lt;- lm(value~Supervisor+Shift+Supervisor:Shift,df_l)

pander(df)</code></pre>
<table style="width:49%;">
<colgroup>
<col width="18%" />
<col width="8%" />
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Supervisor</th>
<th align="center">Day</th>
<th align="center">Swing</th>
<th align="center">Night</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">571</td>
<td align="center">480</td>
<td align="center">470</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">610</td>
<td align="center">474</td>
<td align="center">430</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">625</td>
<td align="center">540</td>
<td align="center">450</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">480</td>
<td align="center">625</td>
<td align="center">630</td>
</tr>
<tr class="odd">
<td align="center">2</td>
<td align="center">516</td>
<td align="center">600</td>
<td align="center">680</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">465</td>
<td align="center">581</td>
<td align="center">661</td>
</tr>
</tbody>
</table>
<pre class="r"><code>panderOptions(&#39;missing&#39;, &quot;&quot;)
panderOptions(&#39;round&#39;, 4)
panderOptions(&#39;plain.ascii&#39;, &#39;TRUE&#39;)
model%&gt;%aov()%&gt;%pander()</code></pre>
<table style="width:93%;">
<caption>Analysis of Variance Model</caption>
<colgroup>
<col width="31%" />
<col width="6%" />
<col width="12%" />
<col width="13%" />
<col width="13%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th></th>
<th align="center">Df</th>
<th align="center">Sum Sq</th>
<th align="center">Mean Sq</th>
<th align="center">F value</th>
<th align="center">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Supervisor</td>
<td align="center">1</td>
<td align="center">19208</td>
<td align="center">19208</td>
<td align="center">26.7</td>
<td align="center">2e-04</td>
</tr>
<tr class="even">
<td>Shift</td>
<td align="center">2</td>
<td align="center">247</td>
<td align="center">124</td>
<td align="center">0.172</td>
<td align="center">0.844</td>
</tr>
<tr class="odd">
<td>Supervisor:Shift</td>
<td align="center">2</td>
<td align="center">81127</td>
<td align="center">40564</td>
<td align="center">56.3</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td>Residuals</td>
<td align="center">12</td>
<td align="center">8640</td>
<td align="center">720</td>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody>
</table>
<pre class="r"><code>tukey_model &lt;- (model%&gt;%aov()%&gt;%TukeyHSD(which = 3,ordered = TRUE))$&#39;Supervisor:Shift&#39;
emphasize.strong.rows(c(5,8,10))
pander(tukey_model,plain.ascii = FALSE)</code></pre>
<table style="width:92%;">
<colgroup>
<col width="30%" />
<col width="13%" />
<col width="15%" />
<col width="13%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">diff</th>
<th align="center">lwr</th>
<th align="center">upr</th>
<th align="center">p adj</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>2:Day-1:Night</strong></td>
<td align="center">37</td>
<td align="center">-36.6</td>
<td align="center">111</td>
<td align="center">0.562</td>
</tr>
<tr class="even">
<td align="center"><strong>1:Swing-1:Night</strong></td>
<td align="center">48</td>
<td align="center">-25.6</td>
<td align="center">122</td>
<td align="center">0.309</td>
</tr>
<tr class="odd">
<td align="center"><strong>2:Swing-1:Night</strong></td>
<td align="center">152</td>
<td align="center">78.4</td>
<td align="center">226</td>
<td align="center">2e-04</td>
</tr>
<tr class="even">
<td align="center"><strong>1:Day-1:Night</strong></td>
<td align="center">152</td>
<td align="center">78.4</td>
<td align="center">226</td>
<td align="center">2e-04</td>
</tr>
<tr class="odd">
<td align="center"><strong>2:Night-1:Night</strong></td>
<td align="center"><strong>207</strong></td>
<td align="center"><strong>133</strong></td>
<td align="center"><strong>281</strong></td>
<td align="center"><strong>0</strong></td>
</tr>
<tr class="even">
<td align="center"><strong>1:Swing-2:Day</strong></td>
<td align="center">11</td>
<td align="center">-62.6</td>
<td align="center">84.6</td>
<td align="center">0.995</td>
</tr>
<tr class="odd">
<td align="center"><strong>2:Swing-2:Day</strong></td>
<td align="center">115</td>
<td align="center">41.4</td>
<td align="center">189</td>
<td align="center">0.0022</td>
</tr>
<tr class="even">
<td align="center"><strong>1:Day-2:Day</strong></td>
<td align="center"><strong>115</strong></td>
<td align="center"><strong>41.4</strong></td>
<td align="center"><strong>189</strong></td>
<td align="center"><strong>0.0022</strong></td>
</tr>
<tr class="odd">
<td align="center"><strong>2:Night-2:Day</strong></td>
<td align="center">170</td>
<td align="center">96.4</td>
<td align="center">244</td>
<td align="center">1e-04</td>
</tr>
<tr class="even">
<td align="center"><strong>2:Swing-1:Swing</strong></td>
<td align="center"><strong>104</strong></td>
<td align="center"><strong>30.4</strong></td>
<td align="center"><strong>178</strong></td>
<td align="center"><strong>0.0049</strong></td>
</tr>
<tr class="odd">
<td align="center"><strong>1:Day-1:Swing</strong></td>
<td align="center">104</td>
<td align="center">30.4</td>
<td align="center">178</td>
<td align="center">0.0049</td>
</tr>
<tr class="even">
<td align="center"><strong>2:Night-1:Swing</strong></td>
<td align="center">159</td>
<td align="center">85.4</td>
<td align="center">233</td>
<td align="center">1e-04</td>
</tr>
<tr class="odd">
<td align="center"><strong>1:Day-2:Swing</strong></td>
<td align="center">0</td>
<td align="center">-73.6</td>
<td align="center">73.6</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center"><strong>2:Night-2:Swing</strong></td>
<td align="center">55</td>
<td align="center">-18.6</td>
<td align="center">129</td>
<td align="center">0.195</td>
</tr>
<tr class="odd">
<td align="center"><strong>2:Night-1:Day</strong></td>
<td align="center">55</td>
<td align="center">-18.6</td>
<td align="center">129</td>
<td align="center">0.195</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="section-worksheet-practical-question-1" class="section level2">
<h2>Worksheet Practical Question 1</h2>
<p>The variation of the strength of (coloring powder) of a dyestuff from one manufacturing batch to another was studied (Davies, 1960). Strength was measured by dyeing a square of cloth with a standard concentration of dyestuff and visually comparing the result with a standard.</p>
<p><br />
The result was numerically scored as the percentage strength of the dyestuff. Large samples were taken from six batches and from each batch six sub-samples were taken. The 36 subsamples were submitted to the laboratory in a random order for testing as described above. Analyse the data using a one-way ANOVA</p>
<!-- <center> -->
<!-- ```{r,echo = FALSE, , message=FALSE, warning=FALSE} -->
<!-- dye <- read_csv("https://www.dropbox.com/s/wpg5t081v5nym9z/dye.csv?dl=1") -->
<!-- dye%>% -->
<!--   kable(align = "c","pipe",digits = 2) -->
<!-- ``` -->
<!-- </center> -->
<div class="tutorial-exercise" data-label="pq1" data-caption="Code" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code>##  Enter Data

dye &lt;- read_csv(&quot;https://www.dropbox.com/s/wpg5t081v5nym9z/dye.csv?dl=1&quot;)
dye &lt;- pivot_longer(dye,cols = names(dye))
names(dye) &lt;- c(&quot;Batch&quot;,&quot;Strength&quot;)
</code></pre>
<script type="application/json" data-opts-chunk="1">{"fig.width":6.5,"fig.height":4,"fig.retina":2,"fig.align":"center","fig.keep":"high","fig.show":"asis","out.width":624,"warning":false,"error":false,"message":false,"exercise.df_print":"paged","exercise.checker":"NULL"}</script>
</div>
<div class="tutorial-exercise-support" data-label="pq1-hint-1" data-caption="Code" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code>model&lt;-lm(Strength~Batch, data = dye)

  anova(model)%&gt;%
  kable(digits = 3, &quot;html&quot;,table.attr = &quot;style=&#39;width:80%;&#39;&quot;,align = &quot;c&quot;)%&gt;%
  kable_styling(position = &quot;center&quot;)
</code></pre>
</div>
<div class="tutorial-exercise-support" data-label="pq1-hint-2" data-caption="Code" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code>model%&gt;%
  aov()%&gt;%
  TukeyHSD()%&gt;%
  extract2(1)%&gt;%
  kable(digits =  3,caption=&quot;Tukey Confidence Intervals for Difference in Treatment Means&quot;,booktabs = TRUE,col.names = c(&quot;Difference of Means&quot;,&quot;LCL&quot;,&quot;UCL&quot;,expression(p-value)),&quot;html&quot;,table.attr = &quot;style=&#39;width:80%;&#39;&quot;,align = &quot;c&quot;)%&gt;%
  kable_styling(position = &quot;center&quot;)
</code></pre>
</div>
</div>
<div id="section-worksheet-practical-question-2" class="section level2">
<h2>Worksheet Practical Question 2</h2>
<p>The concentration (in nanograms per millilitre) of plasma epinephrinewere measured for ten dogs under isofluorane, halothane, cyclopropane anesthesia (Perry, et. al. 1974).</p>
<!-- ```{r, echo = FALSE, message=FALSE, warning=FALSE} -->
<!-- dog<-read_csv("https://www.dropbox.com/s/fjp07jvd48si51z/dog.csv?dl=1") -->
<!-- dog%>% -->
<!--   kable(col.names = c("Anethesia", names(dog)[-1]), align = "c") -->
<!-- ``` -->
<p>Analyse these data using an one-factor ANOVA on the anesthesia</p>
<div class="tutorial-exercise" data-label="pq2" data-caption="Code" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code>dog &lt;- read_csv(&quot;https://www.dropbox.com/s/fjp07jvd48si51z/dog.csv?dl=1&quot;)
dog &lt;- dog%&gt;%
        pivot_longer(cols = names(dog[-1]))
names(dog) &lt;- c(&quot;anesthesia&quot;, &quot;dog&quot;, &quot;epinephrine&quot;)
</code></pre>
<script type="application/json" data-opts-chunk="1">{"fig.width":6.5,"fig.height":4,"fig.retina":2,"fig.align":"center","fig.keep":"high","fig.show":"asis","out.width":624,"warning":false,"error":false,"message":false,"exercise.df_print":"paged","exercise.checker":"NULL"}</script>
</div>
<div class="tutorial-exercise-support" data-label="pq2-hint-1" data-caption="Code" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code>model&lt;-lm(epinephrine~anesthesia, data = dog)

  anova(model)%&gt;%
  kable(digits = 3, &quot;html&quot;,table.attr = &quot;style=&#39;width:80%;&#39;&quot;,align = &quot;c&quot;)%&gt;%
  kable_styling(position = &quot;center&quot;)
</code></pre>
</div>
Now, perform the same ANOVA, but block on the variable “dog”
<div class="tutorial-exercise-support" data-label="pq2-hint-2" data-caption="Code" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code>model&lt;-lm(epinephrine~anesthesia+dog, data = dog)

  anova(model)%&gt;%
  kable(digits = 3, &quot;html&quot;,table.attr = &quot;style=&#39;width:80%;&#39;&quot;,align = &quot;c&quot;)%&gt;%
  kable_styling(position = &quot;center&quot;)
</code></pre>
</div>
<div class="tutorial-exercise-support" data-label="pq2-hint-3" data-caption="Code" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code>model%&gt;%
  aov()%&gt;%
  TukeyHSD()%&gt;%
  extract2(1)%&gt;%
  kable(digits =  3,caption=&quot;Tukey Confidence Intervals for Difference in Treatment Means&quot;,booktabs = TRUE,col.names = c(&quot;Difference of Means&quot;,&quot;LCL&quot;,&quot;UCL&quot;,expression(p-value)),&quot;html&quot;,table.attr = &quot;style=&#39;width:80%;&#39;&quot;,align = &quot;c&quot;)%&gt;%
  kable_styling(position = &quot;center&quot;)</code></pre>
</div>
<p>Comments? Thought?</p>
</div>
<div id="section-worksheet-practical-question-3" class="section level2">
<h2>Worksheet Practical Question 3</h2>
<p>The following data describe the outcome of an experiment where the survival time of animals in hours is measured for anmials receiving one of three poisons and one of four treatments (Box and Cox 1964).</p>
<p>Analyse these data using a one-factor ANOVA for Poison, a two-factor ANOVA for Poison and Treatment (without interaction) and a two-factor ANOVA with interaction between Treatment and Poison</p>
<!-- ```{r, echo = FALSE, message=FALSE, warning=FALSE} -->
<!-- poison <- read_csv("https://www.dropbox.com/s/5bk2sdrvddndl10/poison.csv?dl=1") -->
<!-- poison%>% -->
<!--   kable() -->
<!-- ``` -->
<div class="tutorial-exercise" data-label="pq3" data-caption="Code" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code>poison &lt;- read_csv(&quot;https://www.dropbox.com/s/5bk2sdrvddndl10/poison.csv?dl=1&quot;)
</code></pre>
<script type="application/json" data-opts-chunk="1">{"fig.width":6.5,"fig.height":4,"fig.retina":2,"fig.align":"center","fig.keep":"high","fig.show":"asis","out.width":624,"warning":false,"error":false,"message":false,"exercise.df_print":"paged","exercise.checker":"NULL"}</script>
</div>
<div class="tutorial-exercise-support" data-label="pq3-hint-1" data-caption="Code" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code>model &lt;- lm(Survtime ~ Poison, poison)

anova(model)%&gt;%
    kable(digits = 3, &quot;html&quot;,table.attr = &quot;style=&#39;width:80%;&#39;&quot;,align = &quot;c&quot;)%&gt;%
    kable_styling(position = &quot;center&quot;)
</code></pre>
</div>
<div class="tutorial-exercise-support" data-label="pq3-hint-2" data-caption="Code" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code>model &lt;- lm(Survtime ~ Poison + Treatment, poison)

anova(model)%&gt;%
    kable(digits = 3, &quot;html&quot;,table.attr = &quot;style=&#39;width:80%;&#39;&quot;,align = &quot;c&quot;)%&gt;%
    kable_styling(position = &quot;center&quot;)
</code></pre>
</div>
<div class="tutorial-exercise-support" data-label="pq3-hint-3" data-caption="Code" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code>poison &lt;- read_csv(&quot;https://www.dropbox.com/s/5bk2sdrvddndl10/poison.csv?dl=1&quot;)

model &lt;- lm(Survtime ~ Poison + Treatment + Poison:Treatment , poison)

anova(model)%&gt;%
    kable(digits = 3, &quot;html&quot;,table.attr = &quot;style=&#39;width:80%;&#39;&quot;,align = &quot;c&quot;)%&gt;%
    kable_styling(position = &quot;center&quot;)
</code></pre>
</div>
<div class="tutorial-exercise-support" data-label="pq3-hint-4" data-caption="Code" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code>model%&gt;%
  aov()%&gt;%
  TukeyHSD()%&gt;%
  extract2(1)%&gt;%
  kable(digits =  3,caption=&quot;Tukey Confidence Intervals for Difference in Treatment Means&quot;,booktabs = TRUE,col.names = c(&quot;Difference of Means&quot;,&quot;LCL&quot;,&quot;UCL&quot;,expression(p-value)),&quot;html&quot;,table.attr = &quot;style=&#39;width:80%;&#39;&quot;,align = &quot;c&quot;)%&gt;%
  kable_styling(position = &quot;center&quot;)</code></pre>
</div>
<div class="tutorial-exercise-support" data-label="pq3-hint-5" data-caption="Code" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code>
model%&gt;%
  aov()%&gt;%
  TukeyHSD()%&gt;%
  extract2(2)%&gt;%
  kable(digits =  3,caption=&quot;Tukey Confidence Intervals for Difference in Poison Means&quot;,booktabs = TRUE,col.names = c(&quot;Difference of Means&quot;,&quot;LCL&quot;,&quot;UCL&quot;,expression(p-value)),&quot;html&quot;,table.attr = &quot;style=&#39;width:80%;&#39;&quot;,align = &quot;c&quot;)%&gt;%
  kable_styling(position = &quot;center&quot;)
</code></pre>
</div>
</div>
<div id="section-additional-questions-for-practice" class="section level2">
<h2>Additional Questions for Practice</h2>
<ol style="list-style-type: decimal">
<li>Experimenters infect a group of rates with worms. Eight days later, the experimenters select five rats at random and treat them with carbon tetrachloride. Two days later researchers count the number of worms in each of the rats. This experiemt is repeated four times.</li>
</ol>
<p><br />
Is there reason to suspect that there is a significant difference between replications?</p>
<table>
<thead>
<tr>
<th style="text-align:right;">
‘GroupI’
</th>
<th style="text-align:right;">
‘GroupII’
</th>
<th style="text-align:right;">
‘GroupIII’
</th>
<th style="text-align:right;">
‘GroupIV’
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
279
</td>
<td style="text-align:right;">
378
</td>
<td style="text-align:right;">
172
</td>
<td style="text-align:right;">
381
</td>
</tr>
<tr>
<td style="text-align:right;">
338
</td>
<td style="text-align:right;">
275
</td>
<td style="text-align:right;">
335
</td>
<td style="text-align:right;">
346
</td>
</tr>
<tr>
<td style="text-align:right;">
334
</td>
<td style="text-align:right;">
412
</td>
<td style="text-align:right;">
335
</td>
<td style="text-align:right;">
340
</td>
</tr>
<tr>
<td style="text-align:right;">
198
</td>
<td style="text-align:right;">
265
</td>
<td style="text-align:right;">
282
</td>
<td style="text-align:right;">
471
</td>
</tr>
<tr>
<td style="text-align:right;">
303
</td>
<td style="text-align:right;">
286
</td>
<td style="text-align:right;">
250
</td>
<td style="text-align:right;">
318
</td>
</tr>
</tbody>
</table>
<div class="tutorial-exercise" data-label="aq1" data-caption="Code" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code>rats &lt;- read_csv(&quot;https://www.dropbox.com/s/cigh9i484q51x6h/wormkiller.txt?dl=1&quot;)%&gt;%
  pivot_longer(cols = names(rats))
</code></pre>
<script type="application/json" data-opts-chunk="1">{"fig.width":6.5,"fig.height":4,"fig.retina":2,"fig.align":"center","fig.keep":"high","fig.show":"asis","out.width":624,"warning":false,"error":false,"message":false,"exercise.df_print":"paged","exercise.checker":"NULL"}</script>
</div>
<div class="tutorial-exercise-support" data-label="aq1-solution" data-caption="Code" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code>rats &lt;- read_csv(&quot;https://www.dropbox.com/s/cigh9i484q51x6h/wormkiller.txt?dl=1&quot;)
  rats &lt;- pivot_longer(rats,cols = names(rats))

model &lt;- lm(value~name, rats)

model%&gt;%
  anova()%&gt;%
    kable(digits = 3, &quot;html&quot;,table.attr = &quot;style=&#39;width:80%;&#39;&quot;,align = &quot;c&quot;)%&gt;%
    kable_styling(position = &quot;center&quot;)

model%&gt;%
  aov()%&gt;%
  TukeyHSD()%&gt;%
  extract2(1)%&gt;%
  kable(digits =  3,caption=&quot;Tukey Confidence Intervals for Difference in Treatment Means&quot;,booktabs = TRUE,col.names = c(&quot;Difference of Means&quot;,&quot;LCL&quot;,&quot;UCL&quot;,expression(p-value)),&quot;html&quot;,table.attr = &quot;style=&#39;width:80%;&#39;&quot;,align = &quot;c&quot;)%&gt;%
  kable_styling(position = &quot;center&quot;)
</code></pre>
</div>
<ol start="2" style="list-style-type: decimal">
<li>Researchers studying the effects of lutenizing hormone (LH) conducted an experiment where male rats were either kept under constant light, or were exposed to 14 hours of light followed by ten hours of darkness and given varying doses of lutenizing release hormone (LRH). The researchers recorded the rats’ LH levels.</li>
</ol>
<p><br />
Analyse the data to determine the effect of the light regime and LRH dosage on the production of LH in male rats.</p>
<div class="tutorial-exercise" data-label="aq2" data-caption="Code" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code>rats&lt;-read_csv(&quot;https://www.dropbox.com/s/65evgh4eztsitjq/lhmale.txt?dl=1&quot;)
</code></pre>
<script type="application/json" data-opts-chunk="1">{"fig.width":6.5,"fig.height":4,"fig.retina":2,"fig.align":"center","fig.keep":"high","fig.show":"asis","out.width":624,"warning":false,"error":false,"message":false,"exercise.df_print":"paged","exercise.checker":"NULL"}</script>
</div>
<div class="tutorial-exercise-support" data-label="aq2-solution" data-caption="Code" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code>rats&lt;-read_csv(&quot;https://www.dropbox.com/s/65evgh4eztsitjq/lhmale.txt?dl=1&quot;)
colnames(rats) &lt;- c(&quot;dose&quot;,&quot;normal&quot;,&quot;constant&quot;)
rats$dose&lt;-as.factor(rats$dose)

rats&lt;-pivot_longer(rats,cols = c(normal,constant))
colnames(rats) &lt;- c(&quot;dose&quot;,&quot;light&quot;,&quot;response&quot;)

model &lt;- lm(response~dose+light+dose:light, rats)

model%&gt;%
  anova()%&gt;%
    kable(digits = 3, &quot;html&quot;,table.attr = &quot;style=&#39;width:80%;&#39;&quot;,align = &quot;c&quot;)%&gt;%
    kable_styling(position = &quot;center&quot;)

model%&gt;%
  aov()%&gt;%
  TukeyHSD()%&gt;%
  extract2(1)%&gt;%
  kable(digits =  3,caption=&quot;Tukey Confidence Intervals for Difference in Treatment Means&quot;,booktabs = TRUE,col.names = c(&quot;Difference of Means&quot;,&quot;LCL&quot;,&quot;UCL&quot;,expression(p-value)),&quot;html&quot;,table.attr = &quot;style=&#39;width:80%;&#39;&quot;,align = &quot;c&quot;)%&gt;%
  kable_styling(position = &quot;center&quot;)

model%&gt;%
  aov()%&gt;%
  TukeyHSD()%&gt;%
  extract2(2)%&gt;%
  kable(digits =  3,caption=&quot;Tukey Confidence Intervals for Difference in Treatment Means&quot;,booktabs = TRUE,col.names = c(&quot;Difference of Means&quot;,&quot;LCL&quot;,&quot;UCL&quot;,expression(p-value)),&quot;html&quot;,table.attr = &quot;style=&#39;width:80%;&#39;&quot;,align = &quot;c&quot;)%&gt;%
  kable_styling(position = &quot;center&quot;)
</code></pre>
</div>
<script>
var acc = document.getElementsByClassName("solution");
var i   ;

for (i = 0; i < acc.length; i++) {
  acc[i].addEventListener("click", function() {
    /* Toggle between adding and removing the "active" class,
    to highlight the button that controls the panel */
    this.classList.toggle("active");

    /* Toggle between hiding and showing the active panel */
    var panel = this.nextElementSibling;
    if (panel.style.display === "block") {
      panel.style.display = "none";
    } else {
      panel.style.display = "block";
    }
  });
}
</script>

<script type="application/shiny-prerendered" data-context="server">
learnr:::register_http_handlers(session, metadata = NULL)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
session$onSessionEnded(function() {
        learnr:::session_stop_event(session)
      })
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-pq1-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-pq1-code-editor`)), session)
output$`tutorial-exercise-pq1-output` <- renderUI({
  `tutorial-exercise-pq1-result`()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-pq2-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-pq2-code-editor`)), session)
output$`tutorial-exercise-pq2-output` <- renderUI({
  `tutorial-exercise-pq2-result`()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-pq3-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-pq3-code-editor`)), session)
output$`tutorial-exercise-pq3-output` <- renderUI({
  `tutorial-exercise-pq3-result`()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-aq1-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-aq1-code-editor`)), session)
output$`tutorial-exercise-aq1-output` <- renderUI({
  `tutorial-exercise-aq1-result`()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-aq2-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-aq2-code-editor`)), session)
output$`tutorial-exercise-aq2-output` <- renderUI({
  `tutorial-exercise-aq2-result`()
})
</script>
 <!--html_preserve-->
<script type="application/shiny-prerendered" data-context="dependencies">
{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["header-attrs"]},{"type":"character","attributes":{},"value":["2.11"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/pandoc"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["header-attrs.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.11"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.6.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/3.6.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery-3.6.0.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquerylib"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootstrap"]},{"type":"character","attributes":{},"value":["3.3.5"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/bootstrap"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["viewport"]}},"value":[{"type":"character","attributes":{},"value":["width=device-width, initial-scale=1"]}]},{"type":"character","attributes":{},"value":["js/bootstrap.min.js","shim/html5shiv.min.js","shim/respond.min.js"]},{"type":"character","attributes":{},"value":["css/yeti.min.css"]},{"type":"character","attributes":{},"value":["<style>h1 {font-size: 34px;}\n       h1.title {font-size: 38px;}\n       h2 {font-size: 30px;}\n       h3 {font-size: 24px;}\n       h4 {font-size: 18px;}\n       h5 {font-size: 16px;}\n       h6 {font-size: 12px;}\n       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}\n       pre:not([class]) { background-color: white }<\/style>"]},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.11"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["pagedtable"]},{"type":"character","attributes":{},"value":["1.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/pagedtable-1.1"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/pagedtable.js"]},{"type":"character","attributes":{},"value":["css/pagedtable.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.11"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["highlightjs"]},{"type":"character","attributes":{},"value":["9.12.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/highlightjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["highlight.js"]},{"type":"character","attributes":{},"value":["textmate.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.11"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial.js"]},{"type":"character","attributes":{},"value":["tutorial.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-autocompletion"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-autocompletion.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-diagnostics"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-diagnostics.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-format"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmarkdown/templates/tutorial/resources"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-format.js"]},{"type":"character","attributes":{},"value":["tutorial-format.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.6.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/3.6.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery-3.6.0.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquerylib"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["navigation"]},{"type":"character","attributes":{},"value":["1.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/navigation-1.1"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tabsets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.11"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["highlightjs"]},{"type":"character","attributes":{},"value":["9.12.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/highlightjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["highlight.js"]},{"type":"character","attributes":{},"value":["default.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.11"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.6.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/3.6.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery-3.6.0.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquerylib"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["font-awesome"]},{"type":"character","attributes":{},"value":["5.1.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/fontawesome"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["css/all.css","css/v4-shims.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.11"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootbox"]},{"type":"character","attributes":{},"value":["4.4.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/bootbox"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["bootbox.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["idb-keyvalue"]},{"type":"character","attributes":{},"value":["3.2.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/idb-keyval"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["idb-keyval-iife-compat.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial.js"]},{"type":"character","attributes":{},"value":["tutorial.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-autocompletion"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-autocompletion.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-diagnostics"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-diagnostics.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.2.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["1.5.15"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.2.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["1.5.15"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.2.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["1.5.15"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.2.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["1.5.15"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.2.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["1.5.15"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]}]}
</script>
<!--/html_preserve-->
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="execution_dependencies">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages","version"]},"class":{"type":"character","attributes":{},"value":["data.frame"]},"row.names":{"type":"integer","attributes":{},"value":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93]}},"value":[{"type":"character","attributes":{},"value":["assertthat","backports","base","broom","bslib","cellranger","cli","colorspace","compiler","crayon","curl","datasets","DBI","dbplyr","digest","dplyr","ellipsis","evaluate","fansi","fastmap","forcats","fs","generics","ggplot2","ggtext","gifski","glue","graphics","grDevices","grid","gridExtra","gridtext","gtable","haven","highr","hms","htmltools","htmlwidgets","httpuv","httr","jquerylib","jsonlite","kableExtra","knitr","later","learnr","lifecycle","lubridate","magrittr","markdown","methods","mime","modelr","munsell","MXB107","pander","pillar","pkgconfig","promises","purrr","R6","Rcpp","readr","readxl","reprex","rlang","rmarkdown","rprojroot","rstudioapi","rvest","sass","scales","shiny","stats","stringi","stringr","svglite","systemfonts","tibble","tidyr","tidyselect","tidyverse","tools","utf8","utils","vctrs","viridisLite","webshot","withr","xfun","xml2","xtable","yaml"]},{"type":"character","attributes":{},"value":["0.2.1","1.2.1","4.0.5","0.7.8","0.2.5.1","1.1.0","2.5.0","2.0-2","4.0.5","1.4.1","4.3.2","4.0.5","1.1.1","2.1.1","0.6.27","1.0.7","0.3.2","0.14","0.5.0","1.1.0","0.5.1","1.5.0","0.1.0","3.3.5","0.1.1","1.4.3-1","1.4.2","4.0.5","4.0.5","4.0.5","2.3","0.1.4","0.3.0","2.4.1","0.9","1.1.0","0.5.1.1","1.5.3","1.6.1","1.4.2","0.1.4","1.7.2","1.3.4","1.33","1.2.0","0.10.1","1.0.0","1.7.10","2.0.1","1.1","4.0.5","0.11","0.1.8","0.5.0","1.0.0.2021","0.6.4","1.6.1","2.0.3","1.2.0.1","0.3.4","2.5.0","1.0.6","1.4.0","1.3.1","2.0.0","0.4.11","2.11","2.0.2","0.13","1.0.0","0.4.0","1.1.1","1.6.0","4.0.5","1.6.2","1.4.0","2.0.0","1.0.2","3.1.2","1.1.3","1.1.1","1.3.1","4.0.5","1.2.1","4.0.5","0.3.8","0.4.0","0.5.2","2.4.2","0.24","1.3.2","1.8-4","2.2.1"]}]}]}
</script>
<!--/html_preserve-->
</div>
</div>

</div> <!-- topics -->

<div class="topicsContainer">
<div class="topicsPositioner">
<div class="band">
<div class="bandContent topicsListContainer">

<!-- begin doc-metadata -->
<div id="doc-metadata">
<h2 class="title toc-ignore" style="display:none;">MXB107 Worksheet 10 - Analysis of Variance</h2>
</div>
<!-- end doc-metadata -->

</div> <!-- bandContent.topicsListContainer -->
</div> <!-- band -->
</div> <!-- topicsPositioner -->
</div> <!-- topicsContainer -->


</div> <!-- bandContent page -->
</div> <!-- pageContent band -->




<script>
// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>


</body>

</html>
